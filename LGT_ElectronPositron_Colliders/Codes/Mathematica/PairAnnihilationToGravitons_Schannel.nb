(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80166,       2091]
NotebookOptionsPosition[     76005,       1969]
NotebookOutlinePosition[     76383,       1985]
CellTagsIndexPosition[     76340,       1982]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Declare the angles:
===============\
\>", "Text",
 CellChangeTimes->{{3.6978974751479373`*^9, 3.69789749131225*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"Clear", "[", 
   RowBox[{"theta", ",", "phi"}], "]"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6978502501338987`*^9, 3.6978502626794777`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"theta", "=", "\[Theta]"}], ";"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.697845217232052*^9, 3.69784523419911*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"phi", "=", "\[Phi]"}], ";"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.69784523730467*^9, 3.697845249737641*^9}, {
   3.697890210014604*^9, 3.697890214809169*^9}, 3.697890494512944*^9, {
   3.6978905428383408`*^9, 3.6978905465702705`*^9}}],

Cell["\<\
Dirac Matrices in Wyle representation:
==============================\
\>", "Text",
 CellChangeTimes->{{3.6959531168406105`*^9, 3.6959531337633595`*^9}, {
  3.695953195550635*^9, 3.695953198485695*^9}, {3.704139058710144*^9, 
  3.7041390659275026`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "gamU4", ",", "gamU1", ",", "gamU2", ",", "gamU3", ",", "S", ",", "eeta", 
   ",", "eta"}], "]"}]], "Input",
 CellChangeTimes->{{3.6959686943414865`*^9, 3.6959687479124537`*^9}, {
   3.6959694391430664`*^9, 3.695969441047414*^9}, {3.696234285456789*^9, 
   3.696234289212947*^9}, {3.696345385925763*^9, 3.6963453911106176`*^9}, {
   3.6966100909400663`*^9, 3.696610094705051*^9}, 3.6978516701892385`*^9, {
   3.6978957882235813`*^9, 3.697895795669341*^9}, 3.697928099085379*^9, {
   3.697928333157375*^9, 3.697928333512862*^9}, {3.6996505178696833`*^9, 
   3.699650519200198*^9}}],

Cell["Dirac Matrices in Dirac representation", "Text",
 CellChangeTimes->{{3.6959531168406105`*^9, 3.6959531337633595`*^9}, {
  3.695953195550635*^9, 3.695953198485695*^9}, {3.696231971464815*^9, 
  3.696231974406329*^9}, {3.697890063440801*^9, 3.6978900655576954`*^9}, {
  3.697928277312641*^9, 3.697928279340661*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamU4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.695953203789725*^9, 3.695953310578145*^9}, {
  3.695953353413151*^9, 3.6959533950473824`*^9}, {3.6959686275977526`*^9, 
  3.695968628514129*^9}, {3.696231936397859*^9, 3.696231961893964*^9}, {
  3.696701451169816*^9, 3.696701495199846*^9}, {3.69788326837897*^9, 
  3.697883295555545*^9}, {3.6978984572601438`*^9, 3.697898460124711*^9}, {
  3.6979045759603243`*^9, 3.697904606324191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamU1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6959534308777094`*^9, 3.695953504998402*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamU2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "I", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "I", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "I"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.695953541067957*^9, 3.6959536131790533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamU3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.695953649211501*^9, 3.695953678961337*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gam", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"gam", "[", "i", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "4"}], "]"}], "*", "gamU4"}], "+", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "1"}], "]"}], "*", "gamU1"}], "+", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "2"}], "]"}], "*", "gamU2"}], "+", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "3"}], "]"}], "*", "gamU3"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.695963799861896*^9, 3.6959638238695793`*^9}, {
   3.695967367305809*^9, 3.695967442336368*^9}, 3.695967494789482*^9, {
   3.695968663454299*^9, 3.6959686667752585`*^9}, {3.6959701995547886`*^9, 
   3.6959702057767525`*^9}}],

Cell["\<\
generator of the Lorentz group:
========================\
\>", "Text",
 CellChangeTimes->{{3.70413908412976*^9, 3.704139099846555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"m", ",", "n"}], "]"}], "=", 
    RowBox[{
     RowBox[{"1", "/", "4"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", "m", "]"}], ".", 
        RowBox[{"gam", "[", "n", "]"}]}], "-", 
       RowBox[{
        RowBox[{"gam", "[", "n", "]"}], ".", 
        RowBox[{"gam", "[", "m", "]"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.695967873319313*^9, 3.695967882499872*^9}, {
  3.695967920843149*^9, 3.695967954148718*^9}, {3.695970172035699*^9, 
  3.6959701801628857`*^9}, {3.6979280761042767`*^9, 3.697928099098403*^9}, {
  3.697928314515992*^9, 3.697928321174157*^9}, {3.6991476287791557`*^9, 
  3.6991476349830885`*^9}}],

Cell["\<\
metric tensor:
==========\
\>", "Text",
 CellChangeTimes->{{3.7041391091170816`*^9, 3.7041391191179104`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eeta", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6959685777760496`*^9, 3.6959686137694693`*^9}, 
   3.6959687534205694`*^9, {3.695968833234389*^9, 3.6959688343980274`*^9}, {
   3.697889120118905*^9, 3.697889120689664*^9}, 3.699650461928322*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eta", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"eta", "[", 
    RowBox[{"i", ",", "j"}], "]"}], "=", 
   RowBox[{"eeta", "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.699650473139455*^9, 3.6996505068987513`*^9}}],

Cell["\<\
introduce the photon polarization vector:
assuming that photon is scattered in x-z
plane with angle theta
==============================\
\>", "Text",
 CellChangeTimes->{{3.6990541084193263`*^9, 3.69905413590195*^9}, {
  3.6990567405465136`*^9, 3.6990567719014626`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"xi", ",", "xis", ",", "xi1", ",", "xi2"}], "]"}]], "Input",
 CellChangeTimes->{{3.6990543143848553`*^9, 3.699054332163721*^9}, {
  3.6991184107902784`*^9, 3.699118413282087*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xi1", "[", "theta_", "]"}], ":=", 
   RowBox[{
    RowBox[{"xi1", "[", "theta", "]"}], "=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], ",", "I", ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", "0"}], "}"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6990541687207046`*^9, 3.699054197359865*^9}, {
   3.699054227801905*^9, 3.699054248659227*^9}, {3.6990565722282915`*^9, 
   3.6990566338912325`*^9}, 3.6991033508330874`*^9, {3.6991163369668555`*^9, 
   3.6991163462138376`*^9}, 3.699116394474695*^9, 3.6991181875186377`*^9, 
   3.6991182240511446`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xi2", "[", "theta_", "]"}], ":=", 
   RowBox[{
    RowBox[{"xi2", "[", "theta", "]"}], "=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], ",", 
       RowBox[{"-", "I"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", "0"}], "}"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.699054250202715*^9, 3.699054260444853*^9}, {
   3.699056564347087*^9, 3.699056568035597*^9}, {3.6991163594410133`*^9, 
   3.6991163859066424`*^9}, 3.699118194198812*^9, 3.699118228187683*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xi", "[", 
    RowBox[{"s_", ",", "theta_", ",", "mu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"xi", "[", 
     RowBox[{"s", ",", "theta", ",", "mu"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"s", ",", "1"}], "]"}], "*", 
      RowBox[{
       RowBox[{"xi1", "[", "theta", "]"}], "[", 
       RowBox[{"[", "mu", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"s", ",", "2"}], "]"}], "*", 
      RowBox[{
       RowBox[{"xi2", "[", "theta", "]"}], "[", 
       RowBox[{"[", "mu", "]"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699054263496498*^9, 3.69905430945889*^9}, {
  3.6990566554465814`*^9, 3.6990566752877336`*^9}, {3.699118129274372*^9, 
  3.6991181333324833`*^9}, {3.6996593048441153`*^9, 3.6996593241589527`*^9}, {
  3.6996593938394156`*^9, 3.699659405486229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xis", "[", 
    RowBox[{"s_", ",", "theta_", ",", "mu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"xis", "[", 
     RowBox[{"s", ",", "theta", ",", "mu"}], "]"}], "=", 
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"xi", "[", 
        RowBox[{"s", ",", "theta", ",", "mu"}], "]"}], "]"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{"theta", ",", "Reals"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699118248936302*^9, 3.6991183099576883`*^9}, {
  3.69911834328125*^9, 3.699118386482642*^9}, {3.699120624332945*^9, 
  3.699120625210487*^9}, {3.6996593409356565`*^9, 3.6996593642905874`*^9}}],

Cell["\<\
introduce graviton polarization:
=======================\
\>", "Text",
 CellChangeTimes->{{3.6990541084193263`*^9, 3.69905413590195*^9}, {
  3.6990567405465136`*^9, 3.6990567719014626`*^9}, {3.704228694367598*^9, 
  3.704228706486179*^9}, {3.704229097805686*^9, 3.704229104597198*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"eps", ",", "epsc"}], "]"}]], "Input",
 CellChangeTimes->{{3.69914675154733*^9, 3.6991467600626965`*^9}, {
  3.6991472392977295`*^9, 3.699147244518688*^9}, {3.6996507228805313`*^9, 
  3.6996507240760064`*^9}, {3.6996602902024336`*^9, 3.6996602922381153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eps", "[", 
   RowBox[{"s_", ",", "theta_", ",", "i_", ",", "j_", ",", "mu_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"eps", "[", 
    RowBox[{"s", ",", "theta", ",", "i", ",", "j", ",", "mu"}], "]"}], "=", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"i", "<", "j"}], ",", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"xi", "[", 
       RowBox[{"s", ",", "theta", ",", "mu"}], "]"}]}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", ">", "j"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], "*", 
        RowBox[{"xi", "[", 
         RowBox[{"s", ",", "theta", ",", "mu"}], "]"}]}], ",", "0"}], "]"}]}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.699658890775841*^9, 3.699658925854211*^9}, {
  3.6996592327189436`*^9, 3.6996592331114864`*^9}, {3.69965977099292*^9, 
  3.699659782492191*^9}, {3.699659964845723*^9, 3.6996599747948704`*^9}, {
  3.6996600540715094`*^9, 3.6996601239494257`*^9}, {3.6996601710517907`*^9, 
  3.6996601723963213`*^9}, {3.6997262578754396`*^9, 3.699726262682768*^9}, {
  3.699726297765602*^9, 3.699726298846759*^9}, {3.699726831861945*^9, 
  3.699726862180118*^9}, {3.699726899112257*^9, 3.699726906741802*^9}, {
  3.700427690536551*^9, 3.700427713366089*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"epsc", "[", 
   RowBox[{"s_", ",", "theta_", ",", "i_", ",", "j_", ",", "mu_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"epsc", "[", 
    RowBox[{"s", ",", "theta", ",", "i", ",", "j", ",", "mu"}], "]"}], "=", 
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"eps", "[", 
       RowBox[{"s", ",", "theta", ",", "i", ",", "j", ",", "mu"}], "]"}], 
      "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"theta", ",", "Reals"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6991472535707817`*^9, 3.6991473295857153`*^9}, {
  3.6996507773135104`*^9, 3.699650804952751*^9}}],

Cell["\<\
a momentum four vector:
===================\
\>", "Text",
 CellChangeTimes->{{3.699054458422482*^9, 3.699054520589699*^9}, {
  3.7042287189023952`*^9, 3.704228732334388*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"momm", ",", "mom"}], "]"}]], "Input",
 CellChangeTimes->{{3.6990550666329966`*^9, 3.6990550757454357`*^9}, {
  3.699651216847943*^9, 3.6996512182856326`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"momm", "[", 
    RowBox[{"p_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"momm", "[", 
     RowBox[{"p", ",", "theta"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "*", 
       RowBox[{"Sin", "[", "theta", "]"}]}], ",", "0", ",", 
      RowBox[{"p", "*", 
       RowBox[{"Cos", "[", "theta", "]"}]}], ",", "p"}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.699054522333726*^9, 3.699054538630316*^9}, {
  3.699054578248951*^9, 3.699054596195632*^9}, {3.6990546411107807`*^9, 
  3.6990546703104835`*^9}, {3.6990549813586464`*^9, 3.6990549866450653`*^9}, {
  3.6996512281592903`*^9, 3.6996512314390736`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mom", "[", 
   RowBox[{"p_", ",", "theta_", ",", "mu_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"mom", "[", 
    RowBox[{"p", ",", "theta", ",", "mu"}], "]"}], "=", 
   RowBox[{
    RowBox[{"momm", "[", 
     RowBox[{"p", ",", "theta"}], "]"}], "[", 
    RowBox[{"[", "mu", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6996512435978174`*^9, 3.699651274150736*^9}}],

Cell["\<\
find the rotation matrix in x-z plane:
=========================\
\>", "Text",
 CellChangeTimes->{{3.6979270618558135`*^9, 3.6979271068350363`*^9}, {
  3.699641070495736*^9, 3.699641071717558*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"Clear", "[", 
   RowBox[{"omega", ",", "R"}], "]"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979202680427485`*^9, 3.69792027266748*^9}, {
   3.6979238381298084`*^9, 3.697923849708521*^9}, 3.6979280991053886`*^9, {
   3.697928345186465*^9, 3.6979283463682804`*^9}, {3.699641073440357*^9, 
   3.699641074445367*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"omega", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"omega", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "1"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"j", ",", "3"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"j", ",", "1"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "3"}], "]"}]}]}], ")"}], "*", "theta"}]}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979202456105566`*^9, 3.697920315030781*^9}, {
  3.6979204583835373`*^9, 3.6979205135432453`*^9}, {3.6979235169561586`*^9, 
  3.697923517417499*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{"M", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"m", "=", "1"}], "4"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"n", "=", "1"}], "4"], 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"m", ",", "n"}], "]"}], "*", 
       RowBox[{"omega", "[", 
        RowBox[{"m", ",", "n"}], "]"}]}]}]}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.697920629343872*^9, 3.6979206511350155`*^9}, {
   3.6979206845482655`*^9, 3.6979207090345483`*^9}, {3.6979218310042953`*^9, 
   3.697921833435793*^9}, {3.69792255343871*^9, 3.6979225547714725`*^9}, 
   3.6979226587200193`*^9, {3.6979238247908573`*^9, 3.697923827398219*^9}, {
   3.69792386759616*^9, 3.6979238683070087`*^9}, {3.6979241539967804`*^9, 
   3.697924155083485*^9}, {3.697924231324291*^9, 3.6979242334824114`*^9}, {
   3.6979280991203985`*^9, 3.697928099125415*^9}, {3.697928360123749*^9, 
   3.697928385446358*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["\[Theta]", "2"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Theta]", "2"]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["\[Theta]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[Theta]", "2"]}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6979226596307745`*^9, 3.697923868952597*^9, {3.6979241568330736`*^9, 
   3.697924164852028*^9}, 3.6979243609721985`*^9, 3.6979282942118673`*^9, {
   3.6979283497735643`*^9, 3.6979283914356155`*^9}, 3.697929367551028*^9, 
   3.697929842553978*^9, 3.6979344492710524`*^9, 3.6979759880538993`*^9, 
   3.697979377124358*^9, 3.697980333528705*^9, 3.6979803792538657`*^9, 
   3.697980937934246*^9, 3.6979813380496035`*^9, 3.6980642031034145`*^9, 
   3.698064272110351*^9, 3.6985979830094285`*^9, 3.6987126624783554`*^9, 
   3.6987597915970144`*^9, 3.698760159948285*^9, 3.6987602102712636`*^9, 
   3.698761213426956*^9, 3.6987619068887653`*^9, 3.698764425357743*^9, 
   3.699054719338852*^9, 3.6990595446086593`*^9, {3.699059584519926*^9, 
   3.6990596131567993`*^9}, 3.699102844805317*^9, 3.6991031815905623`*^9, 
   3.6991033572468805`*^9, 3.6991049206516*^9, 3.6991050805901256`*^9, 
   3.69911161616418*^9, 3.699118110225438*^9, 3.699118146045557*^9, 
   3.6991181991266785`*^9, {3.6991195593759327`*^9, 3.699119582157654*^9}, 
   3.6991205887891417`*^9, 3.699120631561023*^9, 3.699120717118695*^9, 
   3.699120801103134*^9, 3.6991208603334675`*^9, {3.6991211776065493`*^9, 
   3.6991212025506644`*^9}, 3.6991218264808903`*^9, 3.6991219255423384`*^9, 
   3.69912223976462*^9, 3.6991224145959387`*^9, 3.699123790701782*^9, 
   3.6991466621932497`*^9, 3.6991479726183453`*^9, 3.6991480864008083`*^9, 
   3.6992289884549875`*^9, 3.699229731062589*^9, 3.699619774218297*^9, 
   3.6996229130488243`*^9, 3.69963082163568*^9, 3.6996309169361167`*^9, 
   3.6996309988825507`*^9, 3.699634397132303*^9, 3.69963577397534*^9, 
   3.699641077291088*^9, 3.6996509839758744`*^9, 3.699651473143623*^9, 
   3.699651555353526*^9, 3.699660355334617*^9, 3.699661756183747*^9, 
   3.699661789715077*^9, 3.6996625721053696`*^9, 3.699663094579643*^9, 
   3.699715820595163*^9, 3.6997245807425385`*^9, 3.6997265876125746`*^9, 
   3.6997269795924997`*^9, 3.699728243329034*^9, 3.699731250875529*^9, 
   3.69979304038443*^9, 3.6997932467178974`*^9, 3.6997939104031076`*^9, 
   3.699795871718687*^9, 3.700427720281452*^9, 3.7004393167701254`*^9, 
   3.7121757528214097`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{"R", "=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "4", "]"}], "+", "M", "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"M", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "6"}], "*", 
     RowBox[{"M", ".", "M", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "24"}], "*", 
     RowBox[{"M", ".", "M", ".", "M", ".", "M"}]}]}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.697921956934961*^9, 3.6979219904973736`*^9}, {
   3.6979225627807517`*^9, 3.6979226004060307`*^9}, 3.6979227123917046`*^9, {
   3.6979238084841733`*^9, 3.6979238205423965`*^9}, {3.6979239035033674`*^9, 
   3.697923904324441*^9}, 3.6979242219580965`*^9, {3.6979244505920486`*^9, 
   3.697924482856279*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["\[Theta]", "2"], "8"], "+", 
      FractionBox[
       SuperscriptBox["\[Theta]", "4"], "384"]}], ",", 
     RowBox[{
      FractionBox["\[Theta]", "2"], "-", 
      FractionBox[
       SuperscriptBox["\[Theta]", "3"], "48"]}], ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Theta]", "2"]}], "+", 
      FractionBox[
       SuperscriptBox["\[Theta]", "3"], "48"]}], ",", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["\[Theta]", "2"], "8"], "+", 
      FractionBox[
       SuperscriptBox["\[Theta]", "4"], "384"]}], ",", "0", ",", "0"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["\[Theta]", "2"], "8"], "+", 
      FractionBox[
       SuperscriptBox["\[Theta]", "4"], "384"]}], ",", 
     RowBox[{
      FractionBox["\[Theta]", "2"], "-", 
      FractionBox[
       SuperscriptBox["\[Theta]", "3"], "48"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Theta]", "2"]}], "+", 
      FractionBox[
       SuperscriptBox["\[Theta]", "3"], "48"]}], ",", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["\[Theta]", "2"], "8"], "+", 
      FractionBox[
       SuperscriptBox["\[Theta]", "4"], "384"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.697924363020336*^9, {3.697924460812532*^9, 3.697924483712427*^9}, 
   3.697928296963208*^9, 3.6979283950433493`*^9, 3.6979293676028833`*^9, 
   3.697929842589*^9, 3.697934449301036*^9, 3.6979759880889*^9, 
   3.6979793771574044`*^9, 3.6979803335607347`*^9, 3.697980379284889*^9, 
   3.697980937964245*^9, 3.697981338088097*^9, 3.698064203133443*^9, 
   3.698064272136877*^9, 3.698597983044937*^9, 3.6987126625073404`*^9, 
   3.698759791631019*^9, 3.6987601599708014`*^9, 3.698760210295767*^9, 
   3.6987612134520245`*^9, 3.69876190690878*^9, 3.6987644253827353`*^9, 
   3.6990547193688517`*^9, 3.6990595446446714`*^9, {3.6990595845499353`*^9, 
   3.699059613191783*^9}, 3.6991028448353167`*^9, 3.6991031816201687`*^9, 
   3.6991033572768793`*^9, 3.69910492067404*^9, 3.6991050806176314`*^9, 
   3.699111616189166*^9, 3.699118110260456*^9, 3.699118146080126*^9, 
   3.699118199150702*^9, {3.699119559410511*^9, 3.699119582187632*^9}, 
   3.6991205888276825`*^9, 3.699120631596065*^9, 3.6991207171490602`*^9, 
   3.6991208011331315`*^9, 3.699120860361513*^9, {3.6991211776415453`*^9, 
   3.699121202580679*^9}, 3.6991218265108676`*^9, 3.699121925575342*^9, 
   3.699122239789623*^9, 3.6991224146259565`*^9, 3.6991237907313085`*^9, 
   3.6991466622182474`*^9, 3.6991479726434593`*^9, 3.6991480864257956`*^9, 
   3.6992289884879885`*^9, 3.699229731098571*^9, 3.6996197743033075`*^9, 
   3.6996229130688343`*^9, 3.699630821676683*^9, 3.6996309169666405`*^9, 
   3.699630998932576*^9, 3.699634397161302*^9, 3.699635774000338*^9, 
   3.699641078352955*^9, 3.6996509840048857`*^9, 3.6996514731686335`*^9, 
   3.699651555383526*^9, 3.6996603553706055`*^9, 3.699661756218253*^9, 
   3.6996617897715826`*^9, 3.6996625721383734`*^9, 3.6996630946136465`*^9, 
   3.6997158206316667`*^9, 3.699724580774551*^9, 3.699726587645124*^9, 
   3.6997269796310043`*^9, 3.6997282444080763`*^9, 3.6997312509056034`*^9, 
   3.699793040414463*^9, 3.6997932467549257`*^9, 3.699793910433092*^9, 
   3.699795871748171*^9, 3.700427720311512*^9, 3.700439316805126*^9, 
   3.7121757528591447`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"theta", "/", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", "4"}], "}"}]}], "]"}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.697924543532609*^9, 3.697924599878289*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   FractionBox[
    SuperscriptBox["\[Theta]", "2"], "8"], "+", 
   FractionBox[
    SuperscriptBox["\[Theta]", "4"], "384"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Theta]", "]"}], "5"],
    SeriesData[$CellContext`\[Theta], 0, {}, 0, 5, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Theta], 0, {1, 0, 
    Rational[-1, 8], 0, 
    Rational[1, 384]}, 0, 5, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6979245764432993`*^9, 3.697924600644202*^9}, 
   3.6979283988325157`*^9, 3.697929367632888*^9, 3.697929842618988*^9, 
   3.697934449356072*^9, 3.6979759882985325`*^9, 3.6979793771910934`*^9, 
   3.697980333588538*^9, 3.697980379316416*^9, 3.6979809379987803`*^9, 
   3.6979813381231003`*^9, 3.6980642033930674`*^9, 3.698064272165386*^9, 
   3.6985979830796027`*^9, 3.6987126626812716`*^9, 3.6987597916640205`*^9, 
   3.698760159994789*^9, 3.698760210319782*^9, 3.698761213471655*^9, 
   3.6987619069337783`*^9, 3.698764425412736*^9, 3.6990547196086893`*^9, 
   3.699059544678687*^9, {3.69905958458494*^9, 3.699059613221784*^9}, 
   3.699102845062435*^9, 3.699103181650153*^9, 3.6991033572964115`*^9, 
   3.6991049206990395`*^9, 3.6991050806450834`*^9, 3.6991116162190185`*^9, 
   3.699118110295456*^9, 3.699118146115139*^9, 3.6991181991817555`*^9, {
   3.6991195594405107`*^9, 3.699119582225649*^9}, 3.699120588859023*^9, 
   3.6991206316210747`*^9, 3.699120717189071*^9, 3.6991208011686583`*^9, 
   3.699120860388156*^9, {3.699121177666546*^9, 3.699121202609687*^9}, 
   3.69912182654073*^9, 3.699121925607375*^9, 3.699122239824142*^9, 
   3.6991224146509705`*^9, 3.699123790761311*^9, 3.69914666234829*^9, 
   3.6991479726684375`*^9, 3.699148086450792*^9, 3.699228988817584*^9, 
   3.6992297311404166`*^9, 3.6996197746108456`*^9, 3.6996229130988455`*^9, 
   3.699630821710684*^9, 3.6996309170036592`*^9, 3.699630998971571*^9, 
   3.699634397187312*^9, 3.6996357740303392`*^9, 3.6996410793879004`*^9, 
   3.6996509841149035`*^9, 3.6996514732036304`*^9, 3.6996515554185276`*^9, 
   3.6996603554121127`*^9, 3.6996617562542562`*^9, 3.6996617898270903`*^9, 
   3.699662572179878*^9, 3.699663094648652*^9, 3.699715820922717*^9, 
   3.6997245808050365`*^9, 3.699726587680108*^9, 3.6997269796650267`*^9, 
   3.6997282453689938`*^9, 3.699731250940603*^9, 3.6997930404494467`*^9, 
   3.699793246787541*^9, 3.699793910468136*^9, 3.6997958717831573`*^9, 
   3.7004277203415146`*^9, 3.7004393168401732`*^9, 3.7121757529750843`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"theta", "/", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", "4"}], "}"}]}], "]"}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.697927141872049*^9, 3.697927145387824*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["\[Theta]", "2"], "-", 
   FractionBox[
    SuperscriptBox["\[Theta]", "3"], "48"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Theta]", "]"}], "5"],
    SeriesData[$CellContext`\[Theta], 0, {}, 1, 5, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Theta], 0, {
    Rational[1, 2], 0, 
    Rational[-1, 48]}, 1, 5, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.6979271461352324`*^9, 3.697928399718725*^9, 3.6979293676603947`*^9, 
   3.6979298426390038`*^9, 3.6979344493760643`*^9, 3.6979759883185153`*^9, 
   3.6979793772111063`*^9, 3.697980333613538*^9, 3.697980379341403*^9, 
   3.6979809380189304`*^9, 3.697981338147613*^9, 3.6980642034085765`*^9, 
   3.6980642721853857`*^9, 3.698597983109605*^9, 3.6987126627012997`*^9, 
   3.69875979168504*^9, 3.6987601600153074`*^9, 3.698760210345787*^9, 
   3.698761213491645*^9, 3.698761906956802*^9, 3.698764425437758*^9, 
   3.6990547196288614`*^9, 3.6990595446986957`*^9, {3.699059584608447*^9, 
   3.699059613247814*^9}, 3.6991028450804443`*^9, 3.6991031816701684`*^9, 
   3.699103357311507*^9, 3.69910492071904*^9, 3.6991050806651*^9, 
   3.699111616239*^9, 3.699118110325494*^9, 3.6991181461401253`*^9, 
   3.699118199201741*^9, {3.6991195594705105`*^9, 3.699119582252668*^9}, 
   3.699120588889042*^9, 3.69912063164606*^9, 3.69912071721906*^9, 
   3.6991208011929455`*^9, 3.6991208604131436`*^9, {3.6991211776916113`*^9, 
   3.6991212026307273`*^9}, 3.6991218265657287`*^9, 3.6991219256373596`*^9, 
   3.6991222398492746`*^9, 3.6991224146759715`*^9, 3.6991237907863107`*^9, 
   3.699146662368306*^9, 3.6991479726884537`*^9, 3.6991480864758615`*^9, 
   3.699228989262099*^9, 3.6992297311714363`*^9, 3.6996197748423753`*^9, 
   3.699622913118845*^9, 3.6996308217396994`*^9, 3.6996309170316677`*^9, 
   3.6996309990175753`*^9, 3.6996343972123137`*^9, 3.6996357740503397`*^9, 
   3.699641080705487*^9, 3.6996509842299595`*^9, 3.699651473234639*^9, 
   3.6996515554536057`*^9, 3.6996603554471145`*^9, 3.6996617562862597`*^9, 
   3.699661789869095*^9, 3.699662572263889*^9, 3.6996630946811557`*^9, 
   3.699715820957706*^9, 3.6997245808315625`*^9, 3.699726587712134*^9, 
   3.6997269796960163`*^9, 3.699728246349312*^9, 3.699731250970583*^9, 
   3.699793040539265*^9, 3.6997932468175244`*^9, 3.699793910498122*^9, 
   3.699795871808175*^9, 3.7004277203755264`*^9, 3.700439316870186*^9, 
   3.7121757530063176`*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{"Clear", "[", "R", "]"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.697924805012638*^9, 3.697924808752718*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"R", "[", "theta_", "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", "theta", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"theta", "/", "2"}], "]"}], ",", 
        RowBox[{"Sin", "[", 
         RowBox[{"theta", "/", "2"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"theta", "/", "2"}], "]"}]}], ",", 
        RowBox[{"Cos", "[", 
         RowBox[{"theta", "/", "2"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         RowBox[{"theta", "/", "2"}], "]"}], ",", 
        RowBox[{"Sin", "[", 
         RowBox[{"theta", "/", "2"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"theta", "/", "2"}], "]"}]}], ",", 
        RowBox[{"Cos", "[", 
         RowBox[{"theta", "/", "2"}], "]"}]}], "}"}]}], "}"}]}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979248783662286`*^9, 3.6979250351767015`*^9}, {
  3.697927237525179*^9, 3.6979272641742306`*^9}, {3.6979273227581997`*^9, 
  3.6979273321261377`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{"R", "[", "theta", "]"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979272802607946`*^9, 3.6979272972582636`*^9}, {
  3.6979273391809683`*^9, 3.6979273398569107`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      FractionBox["\[Theta]", "2"], "]"}], ",", 
     RowBox[{"Sin", "[", 
      FractionBox["\[Theta]", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Theta]", "2"], "]"}]}], ",", 
     RowBox[{"Cos", "[", 
      FractionBox["\[Theta]", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"Cos", "[", 
      FractionBox["\[Theta]", "2"], "]"}], ",", 
     RowBox[{"Sin", "[", 
      FractionBox["\[Theta]", "2"], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Theta]", "2"], "]"}]}], ",", 
     RowBox[{"Cos", "[", 
      FractionBox["\[Theta]", "2"], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.697927303858562*^9, 3.6979273486827745`*^9, 3.6979284043954954`*^9, 
   3.6979293677075806`*^9, 3.6979298426840057`*^9, 3.697934449429061*^9, 
   3.697975988374074*^9, 3.697979377264627*^9, 3.6979803336675777`*^9, 
   3.6979803793944597`*^9, 3.6979809380739317`*^9, 3.697981338208132*^9, 
   3.698064203453578*^9, 3.6980642722253857`*^9, 3.698597983180134*^9, 
   3.698712662750803*^9, 3.698759791745033*^9, 3.698760160063814*^9, 
   3.6987602103912926`*^9, 3.698761213536659*^9, 3.6987619069985976`*^9, 
   3.6987644254927673`*^9, 3.6990547196838355`*^9, 3.699059544748708*^9, {
   3.699059584659783*^9, 3.6990596132968493`*^9}, 3.6991028451204605`*^9, 
   3.69910318171518*^9, 3.6991033573615055`*^9, 3.6991049207740636`*^9, 
   3.699105080724162*^9, 3.6991116162940164`*^9, 3.6991181103955064`*^9, 
   3.6991181461952667`*^9, 3.6991181992617726`*^9, {3.6991195595309343`*^9, 
   3.699119582307683*^9}, 3.699120588954056*^9, 3.699120631711111*^9, 
   3.69912071727942*^9, 3.6991208012479596`*^9, 3.6991208604686794`*^9, {
   3.699121177756629*^9, 3.6991212026907263`*^9}, 3.6991218266312838`*^9, 
   3.6991219257024465`*^9, 3.699122239914277*^9, 3.6991224147410097`*^9, 
   3.699123790846393*^9, 3.6991466624233065`*^9, 3.6991479727439747`*^9, 
   3.6991480865308723`*^9, 3.6992289893636355`*^9, 3.6992297312924457`*^9, 
   3.699619774924386*^9, 3.6996229131678696`*^9, 3.699630821848733*^9, 
   3.6996309170976877`*^9, 3.699630999103619*^9, 3.6996343972673364`*^9, 
   3.6996357741103697`*^9, 3.6996410839439263`*^9, 3.6996509846901207`*^9, 
   3.6996514733036547`*^9, 3.699651555518607*^9, 3.6996603555386267`*^9, 
   3.6996617563602695`*^9, 3.699661789981109*^9, 3.6996625726624403`*^9, 
   3.6996630947546654`*^9, 3.6997158213887625`*^9, 3.6997245809305944`*^9, 
   3.699726587783145*^9, 3.6997269797660685`*^9, 3.6997282492642417`*^9, 
   3.699731251040681*^9, 3.699793040623885*^9, 3.6997932469571157`*^9, 
   3.6997939106331587`*^9, 3.6997958718832035`*^9, 3.700427720447053*^9, 
   3.7004393169452085`*^9, 3.7121757530909767`*^9}]
}, Open  ]],

Cell["\<\
Difine the spinors:
==============\
\>", "Text",
 CellChangeTimes->{{3.6978974986461573`*^9, 3.6978975248249846`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"Clear", "[", 
   RowBox[{
   "u01", ",", "u1", ",", "u02", ",", "u2", ",", "v01", ",", "v1", ",", "v02",
     ",", "v2", ",", "u", ",", "v"}], "]"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6978503696113315`*^9, 3.697850375862343*^9}, {
  3.6978506231435137`*^9, 3.697850624476421*^9}, {3.6979044061343384`*^9, 
  3.6979044475099297`*^9}, {3.6979100916398487`*^9, 3.697910135252735*^9}, {
  3.6979274229221897`*^9, 3.6979274275907335`*^9}, {3.697927510734848*^9, 
  3.697927557119401*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"u01", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"u01", "[", "p", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox["p"]}], ",", "0"}], "}"}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979252530751266`*^9, 3.6979252533726997`*^9}, {
  3.697926762606519*^9, 3.6979267646245317`*^9}, {3.6979274783803525`*^9, 
  3.697927503634713*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"u1", "[", 
    RowBox[{"p_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"u1", "[", 
     RowBox[{"p", ",", "theta"}], "]"}], "=", 
    RowBox[{
     RowBox[{"R", "[", "theta", "]"}], ".", 
     RowBox[{"u01", "[", "p", "]"}]}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.697926876005329*^9, 3.6979268984463034`*^9}, {
  3.697927570192497*^9, 3.6979276062608223`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"u02", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"u02", "[", "p", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox["p"]}], ",", "0", ",", "0"}], "}"}]}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979267733292055`*^9, 3.697926776544934*^9}, {
  3.697927650929525*^9, 3.6979276645309353`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"u2", "[", 
    RowBox[{"p_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"u2", "[", 
     RowBox[{"p", ",", "theta"}], "]"}], "=", 
    RowBox[{
     RowBox[{"R", "[", "theta", "]"}], ".", 
     RowBox[{"u02", "[", "p", "]"}]}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.697926907546141*^9, 3.6979269159590244`*^9}, {
  3.6979276709584045`*^9, 3.6979277022926817`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v01", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"v01", "[", "p", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox["p"]}], ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.697926783686086*^9, 3.69792678815228*^9}, {
  3.6979277488666673`*^9, 3.697927765237121*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v1", "[", 
    RowBox[{"p_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"v1", "[", 
     RowBox[{"p", ",", "theta"}], "]"}], "=", 
    RowBox[{
     RowBox[{"R", "[", "theta", "]"}], ".", 
     RowBox[{"v01", "[", "p", "]"}]}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979269273679757`*^9, 3.6979269605762224`*^9}, {
  3.6979277730631747`*^9, 3.6979277977041817`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v02", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"v02", "[", "p", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["2"]}], " ", 
       SqrtBox["p"]}]}], "}"}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.697926793692544*^9, 3.697926796539242*^9}, {
  3.6979278365378876`*^9, 3.697927848915703*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v2", "[", 
    RowBox[{"p_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"v2", "[", 
     RowBox[{"p", ",", "theta"}], "]"}], "=", 
    RowBox[{
     RowBox[{"R", "[", "theta", "]"}], ".", 
     RowBox[{"v02", "[", "p", "]"}]}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979269689643383`*^9, 3.697926978354537*^9}, {
  3.6979278562708817`*^9, 3.697927891980702*^9}, {3.6996408241167345`*^9, 
  3.6996408263426914`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"p_", ",", "theta_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"p", ",", "theta", ",", "s"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"1", ",", "s"}], "]"}], "*", 
      RowBox[{"u1", "[", 
       RowBox[{"p", ",", "theta"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"2", ",", "s"}], "]"}], "*", 
      RowBox[{"u2", "[", 
       RowBox[{"p", ",", "theta"}], "]"}]}]}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.697927922732397*^9, 3.6979279686406755`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"p_", ",", "theta_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"p", ",", "theta", ",", "s"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"1", ",", "s"}], "]"}], "*", 
      RowBox[{"v1", "[", 
       RowBox[{"p", ",", "theta"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"2", ",", "s"}], "]"}], "*", 
      RowBox[{"v2", "[", 
       RowBox[{"p", ",", "theta"}], "]"}]}]}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.6979280039235945`*^9, 3.6979280142864685`*^9}, {
  3.699640830162525*^9, 3.699640832071658*^9}}],

Cell["\<\
fermion propagator:
(p,theta) for incoming fermion
(k,alpha) for outgoing graviton
=======================\
\>", "Text",
 CellChangeTimes->{{3.697897612442939*^9, 3.6978976273261824`*^9}, {
  3.704229290605196*^9, 3.704229302111681*^9}, {3.704229572340128*^9, 
  3.704229630212341*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "propagFermion", "]"}]], "Input",
 CellChangeTimes->{{3.695973732803794*^9, 3.6959737373842783`*^9}, 
   3.696343310513076*^9, {3.6963435321897125`*^9, 3.6963435325099173`*^9}, 
   3.6978970253284903`*^9, {3.6978973018427343`*^9, 3.6978973028447905`*^9}, {
   3.6990569869947023`*^9, 3.6990570037059584`*^9}, 3.699059483347746*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"propagFermion", "[", 
   RowBox[{"p_", ",", "theta_", ",", "k_", ",", "alpha_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"propagFermion", "[", 
    RowBox[{"p", ",", "theta", ",", "k", ",", "alpha"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"m", "=", "1"}], "4"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"n", "=", "1"}], "4"], 
       RowBox[{
        RowBox[{"eta", "[", 
         RowBox[{"m", ",", "n"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mom", "[", 
           RowBox[{"p", ",", "theta", ",", "m"}], "]"}], "-", 
          RowBox[{"mom", "[", 
           RowBox[{"k", ",", "alpha", ",", "m"}], "]"}]}], ")"}], "*", 
        RowBox[{"gam", "[", "n", "]"}]}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"momm", "[", 
         RowBox[{"p", ",", "theta"}], "]"}], "-", 
        RowBox[{"momm", "[", 
         RowBox[{"k", ",", "alpha"}], "]"}]}], ")"}], ".", "eeta", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"momm", "[", 
         RowBox[{"p", ",", "theta"}], "]"}], "-", 
        RowBox[{"momm", "[", 
         RowBox[{"k", ",", "alpha"}], "]"}]}], ")"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.699057012366769*^9, 3.699057022556567*^9}, {
  3.699057272330735*^9, 3.699057360698638*^9}, {3.6990574205339575`*^9, 
  3.6990574232324452`*^9}, {3.6990574803201075`*^9, 3.6990575531977234`*^9}, {
  3.699057596330818*^9, 3.699057666389719*^9}, {3.6990579857197905`*^9, 
  3.6990580271438465`*^9}, {3.699058092159231*^9, 3.699058094111641*^9}, {
  3.699651335780344*^9, 3.699651381354142*^9}, {3.6996515287192483`*^9, 
  3.6996515375719976`*^9}}],

Cell["\<\
our especific case:
===============\
\>", "Text",
 CellChangeTimes->{{3.697897612442939*^9, 3.6978976273261824`*^9}, {
  3.704229290605196*^9, 3.704229302111681*^9}, {3.704229558028336*^9, 
  3.704229561828087*^9}, {3.7042296358524895`*^9, 3.7042296449646254`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"propagFermion", "[", 
    RowBox[{"p", ",", "0", ",", "p", ",", "theta"}], "]"}], "//", 
   "MatrixForm"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.699104140993802*^9, 3.699104155624687*^9}, {
  3.7004281731786685`*^9, 3.7004281799857364`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      FractionBox["1", 
       RowBox[{"2", " ", "p"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Cot", "[", 
         FractionBox["\[Theta]", "2"], "]"}], 
        RowBox[{"2", " ", "p"}]]}]},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Cot", "[", 
         FractionBox["\[Theta]", "2"], "]"}], 
        RowBox[{"2", " ", "p"}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", "p"}]]}]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", "p"}]]}], 
      FractionBox[
       RowBox[{"Cot", "[", 
        FractionBox["\[Theta]", "2"], "]"}], 
       RowBox[{"2", " ", "p"}]], "0", "0"},
     {
      FractionBox[
       RowBox[{"Cot", "[", 
        FractionBox["\[Theta]", "2"], "]"}], 
       RowBox[{"2", " ", "p"}]], 
      FractionBox["1", 
       RowBox[{"2", " ", "p"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6991041563254995`*^9, 3.699104920974183*^9, 3.6991050809447603`*^9, 
   3.6991116165140953`*^9, 3.699118110720536*^9, 3.699118146420373*^9, 
   3.6991181994873037`*^9, {3.6991195597969675`*^9, 3.699119582537872*^9}, 
   3.6991205892091208`*^9, 3.6991206319564066`*^9, 3.699120717515502*^9, 
   3.6991208015036497`*^9, 3.699120860703532*^9, {3.699121178006771*^9, 
   3.6991212029304695`*^9}, 3.6991218268758783`*^9, 3.6991219259474545`*^9, 
   3.6991222401697564`*^9, 3.699122415001073*^9, 3.6991237911134434`*^9, 
   3.6991466629489236`*^9, 3.6991479729990616`*^9, 3.699148086735946*^9, 
   3.699228989787735*^9, 3.699229731610572*^9, 3.699619775374442*^9, 
   3.699622913412963*^9, 3.6996308221308346`*^9, 3.6996309174177685`*^9, 
   3.699630999486738*^9, 3.699634397556912*^9, 3.6996357743689566`*^9, 
   3.69964112765889*^9, 3.6996509857406497`*^9, 3.6996514740938807`*^9, 
   3.699651555828698*^9, 3.699660355967181*^9, 3.6996617567293167`*^9, 
   3.6996617904446692`*^9, 3.699662573141*^9, 3.6996630951242123`*^9, 
   3.699715821951511*^9, 3.6997245826051025`*^9, 3.699726588126313*^9, 
   3.699726980154269*^9, 3.699728268073449*^9, 3.699731251400312*^9, 
   3.6997930410095763`*^9, 3.6997932473379655`*^9, 3.699793911033433*^9, 
   3.6997958722685924`*^9, 3.700427720857239*^9, 3.7004281809727197`*^9, 
   3.700439317380251*^9, 3.712175753560402*^9}]
}, Open  ]],

Cell["\<\
define self interaction:
(the Lorentz part of it)
================\
\>", "Text",
 CellChangeTimes->{{3.6996222943626623`*^9, 3.699622315275489*^9}, {
  3.704288096405677*^9, 3.7042881156924543`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "XLor", "]"}]], "Input",
 CellChangeTimes->{{3.699702865413108*^9, 3.6997028880311565`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"XLor", "[", 
   RowBox[{
   "i1_", ",", "j1_", ",", "i2_", ",", "j2_", ",", "i3_", ",", "j3_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"XLor", "[", 
    RowBox[{"i1", ",", "j1", ",", "i2", ",", "j2", ",", "i3", ",", "j3"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "4"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"i1", ",", "i3"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"j1", ",", "j2"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"i2", ",", "j3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "4"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"j1", ",", "i3"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"i1", ",", "j2"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"i2", ",", "j3"}], "]"}]}]}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "4"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"i1", ",", "i3"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"j1", ",", "i2"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"j2", ",", "j3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "4"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"j1", ",", "i3"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"i1", ",", "i2"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"j2", ",", "j3"}], "]"}]}]}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "4"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"i1", ",", "j3"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"j1", ",", "j2"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"i2", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", "4"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"j1", ",", "j3"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"i1", ",", "j2"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"i2", ",", "i3"}], "]"}]}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "4"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"i1", ",", "j3"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"j1", ",", "i2"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"j2", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", "4"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"j1", ",", "j3"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"i1", ",", "i2"}], "]"}], "*", 
         RowBox[{"eta", "[", 
          RowBox[{"j2", ",", "i3"}], "]"}]}]}], ")"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6997028967128115`*^9, 3.6997029363408947`*^9}, {
  3.6997155977042665`*^9, 3.6997157551104684`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"XLor", "[", 
  RowBox[{"1", ",", "2", ",", "4", ",", "1", ",", "4", ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6997160838312006`*^9, 3.6997161391337366`*^9}, {
  3.6997178519565325`*^9, 3.6997178551455426`*^9}, {3.6997181430129366`*^9, 
  3.6997181475651846`*^9}, {3.699720528076529*^9, 3.6997205754985666`*^9}, {
  3.6997206485756397`*^9, 3.699720731462618*^9}, {3.6997242489738364`*^9, 
  3.699724288653158*^9}}],

Cell[BoxData[
 FractionBox["1", "4"]], "Output",
 CellChangeTimes->{{3.6997160950026903`*^9, 3.6997161395907393`*^9}, 
   3.699717855673289*^9, {3.69972053784669*^9, 3.699720576547575*^9}, {
   3.699720650874685*^9, 3.699720693509793*^9}, 3.6997219503404922`*^9, {
   3.699724260368028*^9, 3.69972428949516*^9}, 3.6997245829348817`*^9, 
   3.699726588195301*^9, 3.699726980236297*^9, 3.699728286714726*^9, 
   3.6997312514707937`*^9, 3.69979304108961*^9, 3.699793247423169*^9, 
   3.699793911120034*^9, 3.699795872333606*^9, 3.700427720937289*^9, 
   3.700439317450299*^9, 3.7121757536919346`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"UnsameQ", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"XLor", "[", 
               RowBox[{
               "i1", ",", "j1", ",", "i2", ",", "j2", ",", "i3", ",", "j3"}], 
               "]"}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Xlor", "[", 
               RowBox[{
               "i1", ",", "j1", ",", "i2", ",", "j2", ",", "i3", ",", "j3"}], 
               "]"}], "]"}], "\[Rule]", 
             RowBox[{"Simplify", "[", 
              RowBox[{"XLor", "[", 
               RowBox[{
               "i1", ",", "j1", ",", "i2", ",", "j2", ",", "i3", ",", "j3"}], 
               "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i3", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j3", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "5"}], 
      "]"}], ",", "Null"}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6997159096454206`*^9, 3.699715987697233*^9}, {
   3.6997160199359565`*^9, 3.6997160439205027`*^9}, {3.6997174948537645`*^9, 
   3.6997175569668536`*^9}, {3.69971759586989*^9, 3.6997176214534197`*^9}, {
   3.6997177233608537`*^9, 3.6997177490184712`*^9}, {3.6997178214573517`*^9, 
   3.6997178335997934`*^9}, {3.6997178986184177`*^9, 3.699717904479967*^9}, {
   3.699718187018572*^9, 3.6997182073010597`*^9}, 3.699724347715587*^9}],

Cell["\<\
define the whole self interaction:
========================\
\>", "Text",
 CellChangeTimes->{{3.7042881228659472`*^9, 3.704288138979925*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "X", "]"}]], "Input",
 CellChangeTimes->{{3.699622335868236*^9, 3.6996223490461664`*^9}, {
   3.6996629606163807`*^9, 3.6996629619425488`*^9}, 3.699724517131438*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{
   "i1_", ",", "j1_", ",", "mu1_", ",", "i2_", ",", "j2_", ",", "mu2_", ",", 
    "i3_", ",", "j3_", ",", "mu3_", ",", "k2_", ",", "theta2_", ",", "k3_", 
    ",", "theta3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
    "i1", ",", "j1", ",", "mu1", ",", "i2", ",", "j2", ",", "mu2", ",", "i3", 
     ",", "j3", ",", "mu3", ",", "k2", ",", "theta2", ",", "k3", ",", 
     "theta3"}], "]"}], "=", 
   RowBox[{
    RowBox[{"XLor", "[", 
     RowBox[{"i1", ",", "j1", ",", "i2", ",", "j2", ",", "i3", ",", "j3"}], 
     "]"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"mom", "[", 
        RowBox[{"k3", ",", "theta3", ",", "mu2"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"mu3", ",", "mu1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"mom", "[", 
        RowBox[{"k3", ",", "theta3", ",", "mu1"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"mu2", ",", "mu3"}], "]"}]}], "-", 
      RowBox[{"2", "*", 
       RowBox[{"mom", "[", 
        RowBox[{"k2", ",", "theta2", ",", "mu3"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"mu2", ",", "mu1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"mom", "[", 
        RowBox[{"k2", ",", "theta2", ",", "mu1"}], "]"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"mu2", ",", "mu3"}], "]"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6996223189021235`*^9, 3.699622536218173*^9}, {
   3.699623002661051*^9, 3.699623180677102*^9}, 3.6996308154169607`*^9, 
   3.699630859103774*^9, {3.699651014660828*^9, 3.6996510843400517`*^9}, {
   3.69965140990107*^9, 3.699651453481654*^9}, 3.6996611885526295`*^9, 
   3.699661228269472*^9, {3.699715544538026*^9, 3.699715558486313*^9}, 
   3.69972438902504*^9, {3.6997244241558027`*^9, 3.699724465913413*^9}, {
   3.699724524432776*^9, 3.6997245298698344`*^9}, {3.699795844961171*^9, 
   3.699795846154899*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"UnsameQ", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"X", "[", 
               RowBox[{
               "i", ",", "j", ",", "mu", ",", "i2", ",", "j2", ",", "mu2", 
                ",", "i3", ",", "j3", ",", "mu3", ",", "k", ",", "theta", ",",
                 "k", ",", 
                RowBox[{"theta", "+", "Pi"}]}], "]"}], "]"}], ",", "0"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"XX", "[", 
               RowBox[{
               "i", ",", "j", ",", "mu", ",", "i2", ",", "j2", ",", "mu2", 
                ",", "i3", ",", "j3", ",", "mu3", ",", "k", ",", "theta", ",",
                 "k", ",", 
                RowBox[{"theta", "+", "Pi"}]}], "]"}], "]"}], "\[Rule]", 
             RowBox[{"Simplify", "[", 
              RowBox[{"X", "[", 
               RowBox[{
               "i", ",", "j", ",", "mu", ",", "i2", ",", "j2", ",", "mu2", 
                ",", "i3", ",", "j3", ",", "mu3", ",", "k", ",", "theta", ",",
                 "k", ",", 
                RowBox[{"theta", "+", "Pi"}]}], "]"}], "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mu", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mu2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i3", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j3", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mu3", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "8"}], 
      "]"}], ",", "Null"}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6996235438288918`*^9, 3.699623737191365*^9}, {
   3.6996237844803133`*^9, 3.6996237888518925`*^9}, {3.699624022842884*^9, 
   3.6996240334243155`*^9}, {3.699624263389698*^9, 3.6996242641766644`*^9}, 
   3.69962432161193*^9, 3.699641509533597*^9, {3.6996625524571743`*^9, 
   3.699662557628332*^9}, 3.699724551974205*^9, 3.69972468543849*^9, {
   3.6997284852958503`*^9, 3.6997285115421185`*^9}, {3.6997285490717382`*^9, 
   3.699728554720436*^9}, 3.699731244328006*^9, 3.6997944205302525`*^9, 
   3.6997959323312855`*^9}],

Cell["\<\
Find the amplitudes:
pin=p*(1,0,0,1)
 p_1out=p*(1,sin(theta),0,cos(theta))
 p_2out=p*(1,sin(theta+pi),0,cos(theta+pi))
 ================================\
\>", "Text",
 CellChangeTimes->{{3.6978976334063787`*^9, 3.6978976437158194`*^9}, {
  3.6987610638522596`*^9, 3.6987611247276244`*^9}, {3.698761418741403*^9, 
  3.698761459138236*^9}, {3.69876199108326*^9, 3.6987620151479006`*^9}, {
  3.7042882381452*^9, 3.7042882963132844`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "AmplitudeLGT", ",", "AmplitudeLGT1", ",", "AmplitudeLGT2", ",", 
   "AmplitudeLGT22"}], "]"}]], "Input",
 CellChangeTimes->{
  3.699642686027008*^9, {3.699642801979792*^9, 3.6996428030748873`*^9}, 
   3.6996430689216814`*^9, {3.6996483521761155`*^9, 3.6996483664278584`*^9}, {
   3.6997270939036455`*^9, 3.6997271091297894`*^9}, {3.699727876508052*^9, 
   3.699727878005068*^9}}],

Cell["fermionic part of the amplitude times the propagator", "Text",
 CellChangeTimes->{{3.704288472189921*^9, 3.704288496184655*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmplitudeLGT1", "[", 
   RowBox[{"r_", ",", "s_", ",", "mu_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AmplitudeLGT1", "[", 
    RowBox[{"r", ",", "s", ",", "mu", ",", "i", ",", "j"}], "]"}], "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"nu", "=", "1"}], "4"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"m", "=", "1"}], "4"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"n", "=", "1"}], "4"], 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"p", ",", "0", ",", "r"}], "]"}], ".", 
        RowBox[{"gam", "[", "4", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"gam", "[", "nu", "]"}], ".", 
           RowBox[{"S", "[", 
            RowBox[{"m", ",", "n"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"m", ",", "n"}], "]"}], "*", 
           RowBox[{"gam", "[", "nu", "]"}]}]}], ")"}], ".", 
        RowBox[{"u", "[", 
         RowBox[{"p", ",", "0", ",", "s"}], "]"}]}], "*", 
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"eta", "[", 
        RowBox[{"nu", ",", "mu"}], "]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"eta", "[", 
            RowBox[{"m", ",", "i"}], "]"}], "*", 
           RowBox[{"eta", "[", 
            RowBox[{"n", ",", "j"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"eta", "[", 
            RowBox[{"m", ",", "j"}], "]"}], "*", 
           RowBox[{"eta", "[", 
            RowBox[{"n", ",", "i"}], "]"}]}]}], ")"}], "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "p"}], ")"}], "^", "2"}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.699727131363325*^9, 3.6997272363583035`*^9}, {
  3.712175642023038*^9, 3.712175670825965*^9}, {3.712175711207553*^9, 
  3.7121757137253056`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"UnsameQ", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"AmplitudeLGT1", "[", 
               RowBox[{"r", ",", "s", ",", "mu", ",", "i", ",", "j"}], "]"}], 
              "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Amp1", "[", 
               RowBox[{"r", ",", "s", ",", "mu", ",", "i", ",", "j"}], "]"}], 
              "]"}], "\[Rule]", 
             RowBox[{"Simplify", "[", 
              RowBox[{"AmplitudeLGT1", "[", 
               RowBox[{"r", ",", "s", ",", "mu", ",", "i", ",", "j"}], "]"}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mu", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "4"}], 
      "]"}], ",", "Null"}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6997272602610188`*^9, 3.699727351681671*^9}, 
   3.6997312219805603`*^9}],

Cell["\<\
the two outgoin graviton polarizations:
============================\
\>", "Text",
 CellChangeTimes->{{3.704288518472649*^9, 3.7042885384607377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmplitudeLGT22", "[", 
   RowBox[{
   "rp_", ",", "sp_", ",", "i2_", ",", "j2_", ",", "mu2_", ",", "i3_", ",", 
    "j3_", ",", "mu3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AmplitudeLGT22", "[", 
    RowBox[{
    "rp", ",", "sp", ",", "i2", ",", "j2", ",", "mu2", ",", "i3", ",", "j3", 
     ",", "mu3"}], "]"}], "=", 
   RowBox[{
    RowBox[{"epsc", "[", 
     RowBox[{"rp", ",", "theta", ",", "i2", ",", "j2", ",", "mu2"}], "]"}], 
    "*", 
    RowBox[{"epsc", "[", 
     RowBox[{"sp", ",", 
      RowBox[{"theta", "+", "Pi"}], ",", "i3", ",", "j3", ",", "mu3"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.699727886166039*^9, 3.6997279639094343`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"UnsameQ", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"AmplitudeLGT22", "[", 
               RowBox[{
               "rp", ",", "sp", ",", "i2", ",", "j2", ",", "mu2", ",", "i3", 
                ",", "j3", ",", "mu3"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Amp22", "[", 
               RowBox[{
               "rp", ",", "sp", ",", "i2", ",", "j2", ",", "mu2", ",", "i3", 
                ",", "j3", ",", "mu3"}], "]"}], "]"}], "\[Rule]", 
             RowBox[{"Simplify", "[", 
              RowBox[{"AmplitudeLGT22", "[", 
               RowBox[{
               "rp", ",", "sp", ",", "i2", ",", "j2", ",", "mu2", ",", "i3", 
                ",", "j3", ",", "mu3"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"rp", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"sp", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mu2", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i3", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j3", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mu3", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "7"}], 
      "]"}], ",", "Null"}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6997279887888236`*^9, 3.6997280183839493`*^9}, {
   3.699728051787343*^9, 3.699728102165414*^9}, 3.6997312084877353`*^9, {
   3.6997941569139137`*^9, 3.699794178939204*^9}}],

Cell["\<\
the self interaction vertex times the polarizations:
=====================================\
\>", "Text",
 CellChangeTimes->{{3.7042885690109434`*^9, 3.70428858979681*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AmplitudeLGT2", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmplitudeLGT2", "[", 
   RowBox[{"i_", ",", "j_", ",", "mu_", ",", "rp_", ",", "sp_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AmplitudeLGT2", "[", 
    RowBox[{"i", ",", "j", ",", "mu", ",", "rp", ",", "sp"}], "]"}], "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i2", "=", "1"}], "4"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j2", "=", "1"}], "4"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"mu2", "=", "1"}], "4"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i3", "=", "1"}], "4"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j3", "=", "1"}], "4"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"mu3", "=", "1"}], "4"], 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{
           "i", ",", "j", ",", "mu", ",", "i2", ",", "j2", ",", "mu2", ",", 
            "i3", ",", "j3", ",", "mu3", ",", "k", ",", "theta", ",", "k", 
            ",", 
            RowBox[{"theta", "+", "Pi"}]}], "]"}], "*", 
          RowBox[{"AmplitudeLGT22", "[", 
           RowBox[{
           "rp", ",", "sp", ",", "i2", ",", "j2", ",", "mu2", ",", "i3", ",", 
            "j3", ",", "mu3"}], "]"}]}]}]}]}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.699727412345973*^9, 3.6997274738184023`*^9}, 
   3.6997281712564163`*^9, {3.6997297117261667`*^9, 3.699729732209053*^9}, {
   3.6997297906689644`*^9, 3.69972979099841*^9}, {3.69972984543316*^9, 
   3.6997298705849094`*^9}, {3.6997299051961546`*^9, 
   3.6997299441048098`*^9}, {3.69973000309799*^9, 3.699730022898034*^9}, {
   3.699730097602599*^9, 3.6997301395850205`*^9}, 3.6997301815346117`*^9, {
   3.6997302362385445`*^9, 3.699730241901328*^9}, {3.699730325736495*^9, 
   3.699730348736351*^9}, {3.699730388060469*^9, 3.699730419252155*^9}, {
   3.699730667054987*^9, 3.6997306711814947`*^9}, 3.7004391356045265`*^9}],

Cell["\<\
if all the components are zero( see below, they are), the S 
channel has no contribution to the amplitude.
============================================\
\>", "Text",
 CellChangeTimes->{{3.7042886093765335`*^9, 3.704288678118662*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"UnsameQ", "[", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"AmplitudeLGT2", "[", 
              RowBox[{"i", ",", "j", ",", "mu", ",", "rp", ",", "sp"}], "]"}],
              "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"Amp2", "[", 
              RowBox[{"i", ",", "j", ",", "mu", ",", "rp", ",", "sp"}], "]"}],
              "]"}], "\[Rule]", 
            RowBox[{"Simplify", "[", 
             RowBox[{"AmplitudeLGT2", "[", 
              RowBox[{"i", ",", "j", ",", "mu", ",", "rp", ",", "sp"}], "]"}],
              "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mu", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"rp", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"sp", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "4"}], 
     "]"}], ",", "Null"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6997275079941287`*^9, 3.699727613629773*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"{", "}"}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6997276425530634`*^9, 3.6997283984526587`*^9, 3.699729747526122*^9, 
   3.6997298816510506`*^9, 3.699730131413741*^9, 3.699730163413767*^9, 
   3.699730203132098*^9, 3.6997302624071655`*^9, 3.6997303532586374`*^9, {
   3.699730427074424*^9, 3.699730447200491*^9}, {3.699730709604846*^9, 
   3.6997308236110334`*^9}, {3.6997308686011825`*^9, 3.6997309667147007`*^9}, 
   3.6997310070836687`*^9, {3.6997311422415752`*^9, 3.6997311617418995`*^9}, 
   3.699731212369031*^9, 3.6997312993108892`*^9, 3.6997930888539314`*^9, 
   3.699793295965297*^9, 3.699793982509774*^9, 3.6997959176408377`*^9, 
   3.700427763550063*^9, 3.7004393613633704`*^9, 3.7121757978021083`*^9}]
}, Open  ]],

Cell["\<\
total amplitude:
============\
\>", "Text",
 CellChangeTimes->{{3.704288691648166*^9, 3.704288700743751*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmplitudeLGT", "[", 
   RowBox[{"sp_", ",", "s_", ",", "rp_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AmplitudeLGT", "[", 
    RowBox[{"sp", ",", "s", ",", "rp", ",", "r"}], "]"}], "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "4"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"mu", "=", "1"}], "4"], 
      RowBox[{
       RowBox[{"AmplitudeLGT1", "[", 
        RowBox[{"r", ",", "s", ",", "mu", ",", "i", ",", "j"}], "]"}], "*", 
       RowBox[{"AmplitudeLGT2", "[", 
        RowBox[{"i", ",", "j", ",", "mu", ",", "rp", ",", "sp"}], 
        "]"}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.699624955100603*^9, 3.699625144522764*^9}, 
   3.699625189250389*^9, {3.6996252543805723`*^9, 3.699625308547925*^9}, 
   3.699625392489802*^9, {3.699625470870336*^9, 3.6996254878624334`*^9}, {
   3.6996255514022336`*^9, 3.6996255653756*^9}, {3.6996256567933693`*^9, 
   3.6996256918004036`*^9}, {3.699626089609151*^9, 3.6996261151691275`*^9}, {
   3.6996356351830163`*^9, 3.699635636873783*^9}, {3.69963567319699*^9, 
   3.6996356735970445`*^9}, {3.699635739467549*^9, 3.699635744753804*^9}, {
   3.6996419862098956`*^9, 3.6996419995882344`*^9}, {3.699642377250526*^9, 
   3.6996423853487434`*^9}, {3.699642540864274*^9, 3.6996425433308024`*^9}, {
   3.6996425981629877`*^9, 3.6996426570568266`*^9}, {3.699642945511423*^9, 
   3.6996429861983757`*^9}, {3.6996482628045225`*^9, 3.699648307752735*^9}, {
   3.6996483505653105`*^9, 3.699648352151116*^9}, {3.6996508861140375`*^9, 
   3.699650961622933*^9}, {3.699661740180588*^9, 3.6996617433522673`*^9}, {
   3.6996626810400352`*^9, 3.6996626844017797`*^9}, 3.699724567054349*^9, 
   3.6997254549635878`*^9, {3.6997264096697454`*^9, 3.6997264297392263`*^9}, {
   3.699726460481923*^9, 3.6997265227239265`*^9}, {3.6997273823312664`*^9, 
   3.6997273894302053`*^9}, 3.6997276657089496`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"UnsameQ", "[", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"AmplitudeLGT", "[", 
              RowBox[{"sp", ",", "s", ",", "rp", ",", "r"}], "]"}], "]"}], 
            ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"MQED", "[", 
              RowBox[{"sp", ",", "s", ",", "rp", ",", "r"}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"Simplify", "[", 
             RowBox[{"AmplitudeLGT", "[", 
              RowBox[{"sp", ",", "s", ",", "rp", ",", "r"}], "]"}], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"sp", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"rp", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "3"}], "]"}],
     ",", "Null"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6959741549874997`*^9, 3.6959742374296956`*^9}, 
   3.6963303037132196`*^9, 3.6963310675875316`*^9, 3.696343350588417*^9, {
   3.696344833897156*^9, 3.6963448368095164`*^9}, {3.69634535279998*^9, 
   3.696345360235422*^9}, {3.6966119760694327`*^9, 3.69661201447966*^9}, {
   3.6967264335737896`*^9, 3.6967264571333528`*^9}, 3.697891076779046*^9, {
   3.697896270797551*^9, 3.697896293967538*^9}, {3.6991479451113744`*^9, 
   3.699147954116397*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"{", "}"}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6992313422451735`*^9, 3.6996197755159607`*^9, 
  3.6996229134839883`*^9, 3.6996307990351763`*^9, 3.699630912291337*^9, 
  3.6996309940815935`*^9, 3.6996337532952957`*^9, 3.6996349674297094`*^9, 
  3.6996357701386275`*^9, 3.6996409607125998`*^9, 3.6996411698688517`*^9, 
  3.699642586617744*^9, 3.6996426945706277`*^9, 3.6996427475112605`*^9, 
  3.699642809108824*^9, 3.6996428824245815`*^9, 3.6996474468217297`*^9, 
  3.699650971066697*^9, 3.699651551144017*^9, 3.6996588195651093`*^9, 
  3.6996611990139523`*^9, 3.6997267040380983`*^9, 3.699727109447842*^9, 
  3.699728408012866*^9, 3.699731299496007*^9, 3.6997930890340214`*^9, 
  3.6997932961504354`*^9, 3.6997939827558255`*^9, 3.6997959177884064`*^9, 
  3.700427763735145*^9, 3.7004393615084143`*^9, 3.712175797933653*^9}]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.35 Inherited,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 126, 4, 67, "Text"],
Cell[687, 26, 187, 4, 40, "Input"],
Cell[877, 32, 173, 4, 40, "Input"],
Cell[1053, 38, 295, 6, 40, "Input"],
Cell[1351, 46, 263, 6, 67, "Text"],
Cell[1617, 54, 631, 11, 41, "Input"],
Cell[2251, 67, 319, 4, 40, "Text"],
Cell[2573, 73, 845, 19, 41, "Input"],
Cell[3421, 94, 549, 16, 41, "Input"],
Cell[3973, 112, 549, 16, 41, "Input"],
Cell[4525, 130, 547, 16, 41, "Input"],
Cell[5075, 148, 859, 22, 41, "Input"],
Cell[5937, 172, 145, 4, 67, "Text"],
Cell[6085, 178, 824, 22, 41, "Input"],
Cell[6912, 202, 119, 4, 67, "Text"],
Cell[7034, 208, 672, 16, 41, "Input"],
Cell[7709, 226, 336, 10, 41, "Input"],
Cell[8048, 238, 280, 7, 119, "Text"],
Cell[8331, 247, 227, 4, 41, "Input"],
Cell[8561, 253, 752, 19, 41, "Input"],
Cell[9316, 274, 665, 18, 41, "Input"],
Cell[9984, 294, 930, 24, 41, "Input"],
Cell[10917, 320, 707, 17, 41, "Input"],
Cell[11627, 339, 295, 6, 67, "Text"],
Cell[11925, 347, 307, 5, 41, "Input"],
Cell[12235, 354, 1309, 30, 41, "Input"],
Cell[13547, 386, 655, 16, 41, "Input"],
Cell[14205, 404, 184, 5, 67, "Text"],
Cell[14392, 411, 207, 4, 41, "Input"],
Cell[14602, 417, 695, 18, 41, "Input"],
Cell[15300, 437, 402, 11, 41, "Input"],
Cell[15705, 450, 207, 5, 67, "Text"],
Cell[15915, 457, 360, 7, 40, "Input"],
Cell[16278, 466, 844, 24, 40, "Input"],
Cell[CellGroupData[{
Cell[17147, 494, 1011, 23, 79, "Input"],
Cell[18161, 519, 2711, 48, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20909, 572, 768, 19, 40, "Input"],
Cell[21680, 593, 3631, 80, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25348, 678, 308, 9, 40, "Input"],
Cell[25659, 689, 2534, 43, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28230, 737, 308, 9, 40, "Input"],
Cell[28541, 748, 2469, 43, 70, "Output"]
}, Open  ]],
Cell[31025, 794, 153, 3, 40, "Input"],
Cell[31181, 799, 1331, 37, 40, "Input"],
Cell[CellGroupData[{
Cell[32537, 840, 210, 4, 40, "Input"],
Cell[32750, 846, 3000, 57, 65, "Output"]
}, Open  ]],
Cell[35765, 906, 128, 4, 67, "Text"],
Cell[35896, 912, 534, 10, 40, "Input"],
Cell[36433, 924, 471, 13, 60, "Input"],
Cell[36907, 939, 437, 12, 40, "Input"],
Cell[37347, 953, 421, 13, 60, "Input"],
Cell[37771, 968, 439, 12, 40, "Input"],
Cell[38213, 982, 418, 13, 60, "Input"],
Cell[38634, 997, 441, 12, 40, "Input"],
Cell[39078, 1011, 440, 13, 60, "Input"],
Cell[39521, 1026, 490, 13, 40, "Input"],
Cell[40014, 1041, 665, 19, 40, "Input"],
Cell[40682, 1062, 716, 20, 40, "Input"],
Cell[41401, 1084, 296, 8, 119, "Text"],
Cell[41700, 1094, 368, 5, 41, "Input"],
Cell[42071, 1101, 1790, 45, 137, "Input"],
Cell[43864, 1148, 275, 6, 67, "Text"],
Cell[CellGroupData[{
Cell[44164, 1158, 303, 7, 41, "Input"],
Cell[44470, 1167, 2842, 67, 231, "Output"]
}, Open  ]],
Cell[47327, 1237, 209, 6, 93, "Text"],
Cell[47539, 1245, 129, 2, 41, "Input"],
Cell[47671, 1249, 3063, 90, 150, "Input"],
Cell[CellGroupData[{
Cell[50759, 1343, 449, 8, 41, "Input"],
Cell[51211, 1353, 597, 9, 67, "Output"]
}, Open  ]],
Cell[51823, 1365, 2042, 48, 96, "Input"],
Cell[53868, 1415, 151, 4, 67, "Text"],
Cell[54022, 1421, 202, 3, 41, "Input"],
Cell[54227, 1426, 1961, 46, 123, "Input"],
Cell[56191, 1474, 2806, 64, 150, "Input"],
Cell[59000, 1540, 444, 10, 145, "Text"],
Cell[59447, 1552, 431, 9, 41, "Input"],
Cell[59881, 1563, 134, 1, 40, "Text"],
Cell[60018, 1566, 1977, 55, 133, "Input"],
Cell[61998, 1623, 1521, 39, 96, "Input"],
Cell[63522, 1664, 160, 4, 67, "Text"],
Cell[63685, 1670, 700, 19, 69, "Input"],
Cell[64388, 1691, 2047, 49, 150, "Input"],
Cell[66438, 1742, 181, 4, 67, "Text"],
Cell[66622, 1748, 2028, 45, 135, "Input"],
Cell[68653, 1795, 243, 5, 93, "Text"],
Cell[CellGroupData[{
Cell[68921, 1804, 1448, 37, 96, "Input"],
Cell[70372, 1843, 796, 14, 40, "Output"]
}, Open  ]],
Cell[71183, 1860, 119, 4, 67, "Text"],
Cell[71305, 1866, 2021, 38, 78, "Input"],
Cell[CellGroupData[{
Cell[73351, 1908, 1730, 41, 96, "Input"],
Cell[75084, 1951, 905, 15, 40, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
